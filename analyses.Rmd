---
title: "Eastern quoll behaviour and dispersal"
author: "Christina Gee, Belinda Wilson"
date: "14 March 2024"
output:
  html_document:
    toc: true
    number_sections: true
    toc_depth: 3
    toc_float:
      collapsed: true
    theme: cerulean
    highlight: pygments
editor_options: 
  chunk_output_type: console
knit: (function(inputFile, encoding) { rmarkdown::render(inputFile, encoding = encoding, output_file = file.path(dirname(inputFile), 'tutorial.html')) })
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=TRUE, eval=TRUE)
```

# **Background**

Personality can play a crucial role in the survival and dispersal of reintroduced animals. In 2017, we reintroduced a cohort of female-only eastern quolls (*Dasyurus viverrinus*) to a [conservation-fenced haven](https://www.mulligansflat.org.au/) in the Australian Capital Territory, and conducted behavioural assays on each animal prior to their release. We aimed to determine whether personality and plasticity of these animals could predict their post-release performance.

Here we describe the analyses we conducted for our article [Wilson *et al.* (2022) Personality and plasticity predicts post-release performance in a reintroduced mesopredator](https://doi.org/10.1016/j.anbehav.2022.02.019), published in Animal Behaviour.

# **Setup**

First, we installed the [pacman Package Management Tool](https://cran.r-project.org/web/packages/pacman/index.html), which allows us to install and load subsequent packages in a condensed and efficient way. 

```{r, eval=FALSE}
#install.packages("pacman")
```

```{r, results='hide', warning=FALSE, message=FALSE}
# Install and load required packages
pacman::p_load(basemaps, ggplot2, ggpubr, gtools, janitor, lme4,  
               readr, sf, readxl, rstudioapi, tidyverse, viridis)

install.packages("corrplot")
install.packages("beepr")

library(beepr)
library(corrplot)
```

# **Data preparation**

```{r, eval=FALSE}
# Assign raw data filename to an object
raw_data <- "data.xlsx"

# Read in behavioural assay data
raw <- read_excel(raw_data, sheet="Assays", na="N/A") %>% 
  clean_names() %>%
  select("id"="observation_id", 
         "assay_id", 
         "quoll_code",
         behaviour="behavior", 
         occurrences="total_number_of_occurences")

#view(raw)


#Read in the data for all data sheets in excel 
meta <- read_excel(raw_data, sheet="Metadata", na="N/A") %>% 
  clean_names()
#view(meta)

bin <- read_excel(raw_data, sheet="Binned assays", na="N/A")%>%
  clean_names()
#view(bin)

quoll <- read_excel(raw_data, sheet="Quoll", na="N/A") %>%
  clean_names()
#view(quoll)

capture <- read_excel(raw_data, sheet="Captures") %>%
  clean_names()
#view(capture)

sites <- read_excel(raw_data, sheet="Sites") %>%
  clean_names()
#view(sites)

session <- read_excel(raw_data, sheet="Sessions") %>%
  clean_names()
view(session)

trap_eff <- read_excel(raw_data, sheet="Trap effectiveness") %>%
  clean_names()
#view(trap_eff)


#Clean up behaviour data from long to wide format 
occ <- pivot_wider(data = raw, 
                   names_from = behaviour, 
                   values_from = occurrences)  %>%
  clean_names() %>%
  mutate(across(all_of(c("section_1", "section_2", "section_3", "section_4", 
                         "moving", "jump_climb", "food", "legs", 
                         "grooming", "resting", "perch")), as.numeric)) %>%
  rename(section_1_o = "section_1", 
         section_2_o = "section_2", 
         section_3_o = "section_3", 
         section_4_o = "section_4", 
         moving_o = "moving", 
         jump_climb_o = "jump_climb", 
         food_o = "food", 
         legs_o = "legs", 
         grooming_o = "grooming", 
         resting_o = "resting", 
         perch_o = "perch")
#view(occ)


raw <- read_excel(raw_data, sheet="Assays", , na="N/A") %>% 
  clean_names() %>%
  select("id"="observation_id", 
         "assay_id", 
         quoll_code, 
         behaviour="behavior", 
         duration="total_duration_s")

dur <- pivot_wider(data = raw,
                   names_from = behaviour, 
                   values_from = duration) %>%
  clean_names() %>%
  mutate(across(all_of(c("section_1", "section_2", "section_3", "section_4", 
                         "moving", "jump_climb", "food", "legs", 
                         "grooming", "resting", "perch")), as.numeric)) %>%
  rename(section_1_d = "section_1", 
         section_2_d = "section_2", 
         section_3_d = "section_3", 
         section_4_d = "section_4", 
         moving_d = "moving", 
         jump_climb_d = "jump_climb", 
         food_d = "food", 
         legs_d = "legs", 
         grooming_d = "grooming", 
         resting_d = "resting", 
         perch_d = "perch")
#view(dur)

assays <- left_join(occ, dur, by=c("id", "assay_id", "quoll_code"))
view(assays)

# Append metadata for each assay to dataframe
data <- left_join(meta, assays, by=c("assay_id", "quoll_code"))
#view(data)

#this filters out animals which were not assayed
data <- data %>%
  filter(!is.na(assay_number))

data <- left_join(data, bin, by=c("assay_id", "quoll_code", "session"), relationship = "many-to-many")

#view(data)

data <- left_join(data, quoll, by=c("quoll_code"), relationship = "many-to-many")

data <- left_join(data, capture, by=c("quoll_code", "session"), relationship = "many-to-many")

megadata <- left_join(data, session, by=c("session"))


megadata <- megadata %>%
  filter(!is.na(assay_number))

view(megadata)

beep("coin")


```

Adding together values to create new value columns 

```{r}

#Adding all sections together to create a column with total section visitations
megadata$sumsect_o <- rowSums(megadata[, c("section_1_o", "section_2_o", "section_3_o", "section_4_o")])

#Finding out the locations of the relevant columns 
colfoodo <- which(colnames(megadata) == "food_o")
print(colfoodo) #22

restingo <- which(colnames(megadata) == "resting_o")
print(restingo) #28

#Adding together all activity without sections
megadata$totalact_o <- rowSums(megadata[, c(22:28)])

view(megadata)
write.csv(megadata, "megadata.csv")


#Adding a column to turn study site names into binomial 0 and 1 values 
megadata$binomial_study_site <- as.numeric(ifelse(megadata$study_site == "MFWS", 0, ifelse(megadata$study_site == "Goorooyarroo", 1, NA)))

#Filtering out the two individuals who were assayed in Sept 2023
megadata_excl <- megadata %>%
  filter(!(quoll_code %in% c("53328", "87DE0")))

view(megadata_excl)

```


## Correlation analysis

```{r}

#Finding out the locations of the relevant columns 
colfoodo <- which(colnames(megadata) == "food_o")
print(colfoodo) #22

restingo <- which(colnames(megadata) == "resting_o")
print(restingo) #28

colsection4o <- which(colnames(megadata) == "section_4_o")
print(colsection4o) #32

colfoodd <- which(colnames(megadata) == "food_d")
print(colfoodd) #33

restingd <- which(colnames(megadata) == "resting_d")
print(restingd) #39

colsection4d <- which(colnames(megadata) == "section_4_d")
print(colsection4d) #43

#Selecting the appropriate columns for each correlation matrix

#all occurrence and duration columns including sections
cor_o_d <- megadata %>% 
  dplyr::select(22:43)
view(cor_o_d)

#all occurrence columns including sections
cor_o <- megadata %>%
  dplyr::select(22:32)
view(cor_o)

#all duration data including sections 
cor_d <- megadata %>%
  dplyr::select(33:43)
view(cor_d)

#all duration and occurrence data not including sections
cor_od_act <- megadata %>%
  dplyr::select(22:28, 33:39)
view(cor_od_act)

#all occurrence data not including sections
cor_o_act <- megadata %>%
  dplyr::select(22:28)
view(cor_o_act)

#all duration data not including sections
cor_d_act <- megadata %>%
  dplyr::select(33:39)
view(cor_d_act)

#Running the correlations tests for both, then occurrences, then duration, with sections
correlation_od <- cor(cor_o_d)
correlation_o <- cor(cor_o)
correlation_d <- cor(cor_d)

#Running the correlations for both, then occurrences v duration, then occurrences, then duration, without sections
correlation_od_act <- cor(cor_od_act)
correlation_ovd_act <- cor(cor_d_act,cor_o_act)
correlation_occ_act <- cor(cor_o_act)
correlation_dur_act <- cor(cor_d_act)

view(correlation_od)
view(correlation_o)
view(correlation_d)
view(correlation_od_act)
view(correlation_ovd_act)
view(correlation_occ_act)
view(correlation_dur_act)

#Saving them to a .csv file
write.csv(correlation_od, "correlation matrix occ dur all sessions.csv")
write.csv(correlation_o, "correlation matrix occ all sessions.csv")
write.csv(correlation_d, "correlation matrix dur all sessions.csv")
write.csv(correlation_ovd_act, "correlation matrix activity occ vs dur all sessions.csv")
write.csv(correlation_occ_act, "correlation matrix activity occ all sessions.csv")
write.csv(correlation_dur_act, "correlation matrix activity dur all sessions.csv")


#Creating and printing correlation matrix .jpgs which colour code the correlations

#Correlation of occurrences and duration with sections
jpeg(height=2000, width=2000, file="correlation matrix od all sessions.jpeg", type="cairo")
corrplot(correlation_od, method="color", type="upper", #creates a correlation matrix
         cl.cex=3, number.cex=2, tl.cex=3, diag=FALSE,
         tl.col="black", tl.srt=45, addCoef.col="black")
dev.off()

#Correlation of occurrences only with sections
jpeg(height=2000, width=2000, file="correlation matrix occ all sessions.jpeg", type="cairo")
corrplot(correlation_o, method="color", type="upper", #creates a correlation matrix
         cl.cex=3, number.cex=2, tl.cex=3, diag=FALSE,
         tl.col="black", tl.srt=45, addCoef.col="black")
dev.off()

#Correlation of duration only with sections
jpeg(height=2000, width=2000, file="correlation matrix dur all sessions.jpeg", type="cairo")
corrplot(correlation_d, method="color", type="upper", #creates a correlation matrix
         cl.cex=3, number.cex=2, tl.cex=3, diag=FALSE,
         tl.col="black", tl.srt=45, addCoef.col="black")
dev.off()

#Correlations of duration and occurrences without sections
jpeg(height=2000, width=2000, file="correlation matrix occdur act all sessions.jpeg", type="cairo")
corrplot(correlation_od_act, method="color", type="upper", #creates a correlation matrix
         cl.cex=3, number.cex=2, tl.cex=3, diag=FALSE,
         tl.col="black", tl.srt=45, addCoef.col="black")
dev.off()

#Correlations of duration v occurrences without sections
jpeg(height=2000, width=2000, file="correlation matrix occ v dur act all sessions.jpeg", type="cairo")
corrplot(correlation_ovd_act, method="color", type="upper", #creates a correlation matrix
         cl.cex=3, number.cex=2, tl.cex=3, diag=TRUE,
         tl.col="black", tl.srt=45, addCoef.col="black")
dev.off()

#Correlation of occurrences only without sections
jpeg(height=2000, width=2000, file="correlation matrix occ act all sessions.jpeg", type="cairo")
corrplot(correlation_occ_act, method="color", type="upper", #creates a correlation matrix
         cl.cex=3, number.cex=2, tl.cex=3, diag=FALSE,
         tl.col="black", tl.srt=45, addCoef.col="black")
dev.off()

#Correlation of duration only without sections
jpeg(height=2000, width=2000, file="correlation matrix dur act all sessions.jpeg", type="cairo")
corrplot(correlation_dur_act, method="color", type="upper", #creates a correlation matrix
         cl.cex=3, number.cex=2, tl.cex=3, diag=FALSE,
         tl.col="black", tl.srt=45, addCoef.col="black")
dev.off()

```


## Accounting for environmental variables

```{r}

megadata_mutate <- megadata %>%
    mutate_at(vars(5, 148), list(scale))

view(megadata_mutate)

write.csv(megadata_mutate, "megadata mutated.csv")

```


## Running models 

```{r}

#GLM to test duration of moving, first with all individuals, and then excluding the Sept 2023 individuals 
summary(glm(moving_d ~ study_site + temp + assay_number + morph + sex +  age_estimate, data=megadata))
summary(glm(moving_d ~ study_site + temp + assay_number + morph + sex +  age_estimate, data=megadata_excl))


#GLM to test occurrences of moving, first with all individuals, and then excluding the Sept 2023 individuals
summary(glm(moving_o ~ study_site + temp + assay_number + morph + sex +  age_estimate, data=megadata))
summary(glm(moving_o ~ study_site + temp + assay_number + morph + sex +  age_estimate, data=megadata_excl))


```


Plotting Goorooyarroo vs MFWS by action over multiple assays

```{r}

view(megadata)

# Gooroo v Mulligans Moving
mov <- ggplot(megadata, aes(x = as.character(assay_number), y = moving_d, 
                        fill = as.character(assay_number))) + 
  geom_boxplot() +
  facet_wrap(~study_site) + 
  theme_minimal() +
  theme(legend.position = "none", 
        panel.grid = element_blank(),
        axis.line.x = element_line(color = "black"),
        axis.line.y = element_line(color = "black")) + 
  xlab("Assay number") + ylab("Moving duration (s)") + labs("")
print(mov)

movo <- ggplot(megadata, aes(x = as.character(assay_number), y = moving_o, 
                        fill = as.character(assay_number))) + 
  geom_boxplot() +
  facet_wrap(~study_site) + 
  theme_minimal() +
  theme(legend.position = "none", 
        panel.grid = element_blank(),
        axis.line.x = element_line(color = "black"),
        axis.line.y = element_line(color = "black")) + 
  xlab("Assay number") + ylab("Moving occurrences (n)") + labs("")
print(movo)

movo_age <- ggplot(megadata, aes(x = as.character(age_estimate), y = moving_o, 
                        fill = as.character(age_estimate))) + 
  geom_boxplot() +
  facet_wrap(~study_site) + 
  theme_minimal() +
  theme(legend.position = "none", 
        panel.grid = element_blank(),
        axis.line.x = element_line(color = "black"),
        axis.line.y = element_line(color = "black")) + 
  xlab("Age estimate") + ylab("Moving occurrences (n)") + labs("")
print(movo_age)

movd_age<- ggplot(megadata, aes(x = as.character(age_estimate), y = moving_d, 
                        fill = as.character(age_estimate))) + 
  geom_boxplot() +
  facet_wrap(~study_site) + 
  theme_minimal() +
  theme(legend.position = "none", 
        panel.grid = element_blank(),
        axis.line.x = element_line(color = "black"),
        axis.line.y = element_line(color = "black")) + 
  xlab("Age estimate") + ylab("Moving duration (s)") + labs("")
print(movd_age)

movd_ageno<- ggplot(megadata, aes(x = as.character(age_estimate), y = moving_d, 
                        fill = as.character(age_estimate))) + 
  geom_boxplot() + 
  facet_wrap(~assay_number) +
  theme_minimal() +
  theme(legend.position = "none", 
        panel.grid = element_blank(),
        axis.line.x = element_line(color = "black"),
        axis.line.y = element_line(color = "black")) + 
  xlab("Age estimate") + ylab("Moving duration (s)") + labs("")
print(movd_ageno)


movd_sexno<- ggplot(megadata, aes(x = as.character(sex), y = moving_d, 
                        fill = as.character(sex))) + 
  geom_boxplot() + 
  facet_wrap(~study_site) +
  theme_minimal() +
  theme(legend.position = "none", 
        panel.grid = element_blank(),
        axis.line.x = element_line(color = "black"),
        axis.line.y = element_line(color = "black")) + 
  xlab("Sex") + ylab("Moving duration (s)") + labs("")
print(movd_sexno)



#GS v Mulligans moving with random variables 
mod <- lmer(moving_o ~ study_site + temp + assay_number + 
              (1|quoll_code), data=data)
# Statistics
summary(mod)

# p-values
car::Anova(mod)

# Gooroo v Mulligans Grooming
groom <- ggplot(data, aes(x = as.character(assay_number), y = grooming_d, 
                        fill = as.character(assay_number))) + 
  geom_violin() +
  facet_wrap(~study_site) + 
  theme_minimal() +
  theme(legend.position = "none", 
        panel.grid = element_blank(),
        axis.line.x = element_line(color = "black"),
        axis.line.y = element_line(color = "black")) +
  xlab("Assay number") + ylab("Grooming duration (s)") + labs("")
print(groom)

groomo <- ggplot(data, aes(x = as.character(assay_number), y = grooming_o, 
                        fill = as.character(assay_number))) + 
  geom_violin() +
  facet_wrap(~study_site) + 
  theme_minimal() +
  theme(legend.position = "none", 
        panel.grid = element_blank(),
        axis.line.x = element_line(color = "black"),
        axis.line.y = element_line(color = "black")) +
  xlab("Assay number") + ylab("Grooming occurrences (n)") + labs("")
print(groomo)

summary(glm(grooming_d ~ study_site + temp + assay_number, data=data))
summary(glm(grooming_o ~ study_site + temp + assay_number, data=data))



# Gooroo v Mulligans Food
food <- ggplot(data, aes(x = as.character(assay_number), 
                         y = -remaining_bait_g+60, 
                         fill = as.character(assay_number))) + 
  geom_boxplot() +
  facet_wrap(~study_site) + 
  theme_minimal() +
  theme(legend.position = "none", 
        panel.grid = element_blank(),
        axis.line.x = element_line(color = "black"),
        axis.line.y = element_line(color = "black")) +
  scale_fill_manual(values = c("1" = "pink", "2" = "red")) +
  xlab("Assay number") + ylab("Bait eaten (g)") + labs("")
print(food)


foodd <- ggplot(data, aes(x = as.character(assay_number), y = food_d, 
                        fill = as.character(assay_number))) + 
  geom_boxplot() +
  facet_wrap(~study_site) + 
  theme_minimal() +
  theme(legend.position = "none", 
        panel.grid = element_blank(),
        axis.line.x = element_line(color = "black"),
        axis.line.y = element_line(color = "black")) +
  scale_fill_manual(values = c("1" = "pink", "2" = "red")) +
  xlab("Assay number") + ylab("Food interaction duration (s)") + labs("")

print(foodo)

foodd <- ggplot(data, aes(x = as.character(assay_number), y = food_o, 
                        fill = as.character(assay_number))) + 
  geom_boxplot() +
  facet_wrap(~study_site) + 
  theme_minimal() +
  theme(legend.position = "none", 
        panel.grid = element_blank(),
        axis.line.x = element_line(color = "black"),
        axis.line.y = element_line(color = "black")) +
  scale_fill_manual(values = c("1" = "pink", "2" = "red")) +
  xlab("Assay number") + ylab("Food interaction occurrences (n)") + labs("")

print(foodd)


summary(glm(food_d ~ study_site + temp + assay_number, data=data))
summary(glm(food_o ~ study_site + temp + assay_number, data=data))
summary(glm(remaining_bait_g ~ study_site + temp + assay_number, data=data))



# Gooroo v Mulligans Perching 
perch <- ggplot(data, aes(x = as.character(assay_number), y = perch_d, 
                        fill = as.character(assay_number))) + 
  geom_boxplot() +
  facet_wrap(~study_site) + 
  theme_minimal() +
  theme(legend.position = "none", 
        panel.grid = element_blank(),
        axis.line.x = element_line(color = "black"),
        axis.line.y = element_line(color = "black")) +
  scale_fill_manual(values = c("1" = "pink", "2" = "red")) +
  xlab("Assay number") + ylab("Perching duration (s)") + labs("")

print(perch)


percho <- ggplot(data, aes(x = as.character(assay_number), y = perch_o, 
                        fill = as.character(assay_number))) + 
  geom_boxplot() +
  facet_wrap(~study_site) + 
  theme_minimal() +
  theme(legend.position = "none", 
        panel.grid = element_blank(),
        axis.line.x = element_line(color = "black"),
        axis.line.y = element_line(color = "black")) +
  scale_fill_manual(values = c("1" = "pink", "2" = "red")) +
  xlab("Assay number") + ylab("Perching occurrence (n)") + labs("")

print(percho)


summary(glm(perch_d ~ study_site + temp + assay_number, data=data))
summary(glm(perch_o ~ study_site + temp + assay_number, data=data))


# Gooroo v Mulligans meerkatting 
legs <- ggplot(data, aes(x = as.character(assay_number), y = legs_d, 
                        fill = as.character(assay_number))) + 
  geom_boxplot() +
  facet_wrap(~study_site) + 
  theme_minimal() +
  theme(legend.position = "none", 
        panel.grid = element_blank(),
        axis.line.x = element_line(color = "black"),
        axis.line.y = element_line(color = "black")) +
  scale_fill_manual(values = c("1" = "pink", "2" = "red")) +
  xlab("Assay number") + ylab("Meerkatting duration (s)") + labs("")

print(legs)


legso <- ggplot(data, aes(x = as.character(assay_number), y = legs_o, 
                        fill = as.character(assay_number))) + 
  geom_boxplot() +
  facet_wrap(~study_site) + 
  theme_minimal() +
  theme(legend.position = "none", 
        panel.grid = element_blank(),
        axis.line.x = element_line(color = "black"),
        axis.line.y = element_line(color = "black")) +
  scale_fill_manual(values = c("1" = "pink", "2" = "red")) +
  xlab("Assay number") + ylab("Meerkatting occurrences (n)") + labs("")

print(legso)

summary(glm(legs_d ~ study_site + temp + assay_number, data=data))
summary(glm(legs_o ~ study_site + temp + assay_number, data=data))


# Gooroo v Mulligans jumping/climbing 
jumpd <- ggplot(data, aes(x = as.character(assay_number), y = jump_climb_d, 
                        fill = as.character(assay_number))) + 
  geom_boxplot() +
  facet_wrap(~study_site) + 
  theme_minimal() +
  theme(legend.position = "none", 
        panel.grid = element_blank(),
        axis.line.x = element_line(color = "black"),
        axis.line.y = element_line(color = "black")) +
  scale_fill_manual(values = c("1" = "pink", "2" = "red")) +
  xlab("Assay number") + ylab("Jumping/climbing duration (s)") + labs("")

print(jumpd)


jumpo <- ggplot(data, aes(x = as.character(assay_number), y = jump_climb_o, 
                        fill = as.character(assay_number))) + 
  geom_boxplot() +
  facet_wrap(~study_site) + 
  theme_minimal() +
  theme(legend.position = "none", 
        panel.grid = element_blank(),
        axis.line.x = element_line(color = "black"),
        axis.line.y = element_line(color = "black")) +
  scale_fill_manual(values = c("1" = "pink", "2" = "red")) +
  xlab("Assay number") + ylab("Jumping/climbing occurrences (n)") + labs("")

print(jumpo)

summary(glm(jump_climb_d ~ study_site + temp + assay_number, data=data))
summary(glm(jump_climb_o ~ study_site + temp + assay_number, data=data))


# Gooroo v Mulligans Section visitation occurrences 
sect_o <- ggplot(data, aes(x = as.character(assay_number), y = sumsect_o, 
                        fill = as.character(assay_number))) + 
  geom_violin() +
  facet_wrap(~study_site) + 
  theme_minimal() +
  theme(legend.position = "none", 
        panel.grid = element_blank(),
        axis.line.x = element_line(color = "black"),
        axis.line.y = element_line(color = "black")) + 
  xlab("Assay number") + ylab("Total movements across all sections (n)") + labs("")

print(sect_o)


summary(glm(formula = sumsect_o ~ study_site + temp + assay_number, data=data))
summary(glm(formula = sumsect_o ~ study_site + sex + temp + assay_number, data=sexdata))


# Gooroo v Mulligans total activity occurrences minus sections
act_o <- ggplot(data, aes(x = as.character(assay_number), y = totalact_o, 
                        fill = as.character(assay_number))) + 
  geom_violin() +
  facet_wrap(~study_site) + 
  theme_minimal() +
  theme(legend.position = "none", 
        panel.grid = element_blank(),
        axis.line.x = element_line(color = "black"),
        axis.line.y = element_line(color = "black")) + 
  xlab("Assay number") + ylab("Total activity (n)") + labs("")

print(act_o)

summary(glm(formula = totalact_o ~ study_site + temp + assay_number, data=data))



```

## Map

```{r, warning=FALSE}
# Read in and project MFWS fence shapefile using rgdal
mfws <- readOGR(dsn="shapefiles/MFGO_fences_and surrounds.shp", verbose=FALSE) %>% 
  spTransform(CRS("+proj=utm +zone=55 +ellps=WGS84")) %>%
  # Transform shapefile into a dataframe
  fortify(verbose=FALSE) %>%
  mutate(lat=as.numeric(lat + 10000000), 
         long=as.numeric(long))

# Read in and project MFGO fence shapefile using rgdal
mfgo <- st_read("shapefiles/MFGO_fences.shp", quiet=TRUE) %>%
  # Set projection to eastings/northings
  st_set_crs("EPSG:32755") %>% 
  # Reproject to lat/long
  st_transform("EPSG:4326")

# Plot den locations on MFWS map for each trial
map <- ggplot() + 
  geom_polygon(mfws, mapping=aes(x=long, y=lat, group=group), col="grey15") +
  #coord_sf(xlim=c(695750, 699250), ylim=c(6104250, 6107750)) +
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        panel.background = element_rect(fill="white"),
        axis.text.x = element_blank(), 
        axis.text.y = element_blank(), 
        axis.ticks.x = element_blank(),
        axis.ticks.y = element_blank(),
        legend.key = element_blank(), 
        strip.background = element_blank()) +
  #facet_wrap(~factor(year_of_acquisition), ncol=3) +
  #scale_colour_manual(values = viridis(3, begin=0.9, end=0.1)) +
  xlab("") + ylab("") + labs(col="Trial")
print(map)
```



```{r}
jpeg(file="mfgo_fences_and_surrounds.jpeg", 
     width=4750, height=1500, units="px", res=500)
map
dev.off()
```

# **Analysis**

```{r}

```


# **Session information**

```{r}
# Display version information for R, OS, and packages
sessionInfo()
```